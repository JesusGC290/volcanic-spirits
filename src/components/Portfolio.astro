---
// src/components/Portfolio.astro
import { Image } from "astro:assets";

// CAMBIO CLAVE: Ya no importamos 'en.json'. Definimos las props que vamos a recibir.
interface Props {
  content: any;
}
// Recibimos 'content' y lo renombramos a 'portfolio' para que el resto del código no cambie.
const { content: portfolio } = Astro.props;

// Importamos TODAS las imágenes que usaremos en el portafolio
import caminanteImage from "../assets/images/tequila-op.png";
import caminanteBgImage from "../assets/images/templo.jpg";
import yuliiaImage from "../assets/images/yuliia.png";
import yuliiaBgImage from "../assets/images/horno.jpg";
import huacoImage from "../assets/images/huaco.png";
import huacoBgImage from "../assets/images/mix.jpg";
import fortunaImage from "../assets/images/fortuna.png";
import fortunaBgImage from "../assets/images/preparation.jpg";
import morettImage from "../assets/images/Botella_Morett_Transparency.png";
import morettBgImage from "../assets/images/bg-Morett.jpg";
import talavaImage from "../assets/images/talava-tequila.png";
import talavaBgImage from "../assets/images/talava-bg.jpg";

// Esta lógica ahora funciona con el 'portfolio' que viene de las props.
const caminanteData = portfolio.brands.find((brand: any) => brand.name === "Caminante Tequila");
const yuliiaData = portfolio.brands.find((brand: any) => brand.name === "YULIIA Mezcal");
const huacoData = portfolio.brands.find((brand: any) => brand.name === "Huaco Agave Distillate");
const fortunaData = portfolio.brands.find((brand: any) => brand.name === "Cerveza Fortuna");
const morettData = portfolio.brands.find((brand: any) => brand.name === "Morett Tequila");
const talavaData = portfolio.brands.find((brand: any) => brand.name === "Talava");
---

<section id="portfolio" class="bg-accent">
  <div class="py-20 sm:py-24">
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
      <div class="text-center max-w-3xl mx-auto">
        <h2 class="font-display text-4xl lg:text-5xl font-bold text-text animate-on-scroll">
          {portfolio.title}
        </h2>
        <p class="font-body mt-4 text-lg text-text/70 leading-relaxed animate-on-scroll">
          {portfolio.subtitle}
        </p>
      </div>
    </div>
  </div>
</section>

{
  talavaData && (
    <section id="talava-parallax" class="bg-[var(--color-wood)] py-20 sm:py-24 lg:h-[800px] lg:py-0">
      <div class="max-w-7xl mx-auto px-6 lg:px-8 h-full">
        {/* Contenedor principal que cambia de flex-col a un layout relativo en desktop */}
        <div class="flex flex-col lg:relative items-center justify-center h-full">
          {/* Imagen de fondo (solo para desktop) */}
          <div class="parallax-bg hidden lg:block lg:absolute w-full lg:w-4/5 h-[600px]">
            <Image
              src={talavaBgImage}
              alt={`Ambiance for ${talavaData.name}`}
              quality="high"
              class="rounded-lg shadow-2xl shadow-accent/50 h-full w-full object-cover"
            />
          </div>

          {/* Botella (visible en móvil y desktop) */}
          <div class="parallax-bottle w-2/3 sm:w-1/3 lg:absolute lg:inset-0 lg:flex lg:items-center lg:justify-start lg:w-auto animate-on-scroll lg:animate-none">
            <Image
              src={talavaImage}
              alt={`Bottle of ${talavaData.name}`}
              class="lg:h-full lg:max-h-[550px] w-auto drop-shadow-2xl"
            />
          </div>

          {/* Tarjeta de texto (visible en móvil y desktop) */}
          <div class="parallax-card w-full mt-8 lg:absolute lg:inset-0 lg:flex lg:items-end lg:justify-end lg:mt-0 animate-on-scroll lg:animate-none">
            <div class="w-full lg:w-2/3 bg-text/80 backdrop-blur-sm p-8 md:p-10 rounded-lg shadow-xl text-background lg:m-8">
              <h3 class="font-display text-4xl md:text-6xl font-bold">{talavaData.name}</h3>
              <div class="w-24 h-1 bg-primary mt-4" />
              <div class="mt-8 grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4 text-sm font-body uppercase tracking-wider">
                <p><strong>Category:</strong><br /> {talavaData.category}</p>
                <p><strong>Origin:</strong><br /> {talavaData.origin}</p>
                <p><strong>Alcohol:</strong><br /> {talavaData.alcohol}</p>
                {talavaData.volume && (
                  <p>
                    <strong>Volume:</strong><br />
                    {talavaData.volume}
                  </p>
                )}
              </div>
              <p class="font-body mt-8 text-lg text-background/80 leading-relaxed">{talavaData.description}</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

{
  morettData && (
    <section
      class="relative bg-cover bg-center bg-fixed py-24 sm:py-32"
      style={{ backgroundImage: `url(${morettBgImage.src})` }}
    >
      <div class="absolute inset-0 bg-black/60" />
      <div class="relative z-10 max-w-7xl mx-auto px-6 lg:px-8">
        <div class="grid grid-cols-1 lg:grid-cols-5 items-center gap-8 lg:gap-0">
          <div class="lg:col-span-3 animate-on-scroll">
            <div class="bg-background/80 backdrop-blur-sm p-8 md:p-10 rounded-lg shadow-xl text-text">
              <h3 class="font-display text-4xl md:text-6xl font-bold text-text">{morettData.name}</h3>
              <div class="w-24 h-1 bg-primary mt-4" />
              <div class="mt-8 grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4 text-sm font-body uppercase tracking-wider">
                <p>
                  <>
                    <strong>Category:</strong>
                    <br />
                  </>{" "}
                  {morettData.category}
                </p>
                <p>
                  <>
                    <strong>Origin:</strong>
                    <br />
                  </>{" "}
                  {morettData.origin}
                </p>
                <p>
                  <>
                    <strong>Alcohol:</strong>
                    <br />
                  </>{" "}
                  {morettData.alcohol}
                </p>
                <p>
                  <>
                    <strong>Distillation:</strong>
                    <br />
                  </>{" "}
                  {morettData.distillation}
                </p>
              </div>
              <p class="font-body mt-8 text-lg text-text/80 leading-relaxed">{morettData.description}</p>
            </div>
          </div>
          <div class="lg:col-span-2 flex justify-center animate-on-scroll order-first lg:order-last">
            <Image
              src={morettImage}
              alt={`Bottle of ${morettData.name}`}
              quality="high"
              class="h-full max-h-[550px] w-auto drop-shadow-2xl"
            />
          </div>
        </div>
      </div>
    </section>
  )
}

{
  huacoData && (
    <section id="huaco-parallax" class="bg-[var(--color-wood)] py-20 sm:py-24 lg:h-[800px] lg:py-0">
      <div class="max-w-7xl mx-auto px-6 lg:px-8 h-full">
        {/* Contenedor principal que cambia de flex-col a un layout relativo en desktop */}
        <div class="flex flex-col lg:relative items-center justify-center h-full">
          {/* Imagen de fondo (solo para desktop) */}
          <div class="parallax-bg hidden lg:block lg:absolute w-full lg:w-4/5 h-[600px]">
            <Image
              src={huacoBgImage}
              alt={`Ambiance for ${huacoData.name}`}
              quality="high"
              class="rounded-lg shadow-2xl shadow-accent/50 h-full w-full object-cover"
            />
          </div>

          {/* Botella (visible en móvil y desktop) */}
          <div class="parallax-bottle w-2/3 sm:w-1/3 lg:absolute lg:inset-0 lg:flex lg:items-center lg:justify-start lg:w-auto animate-on-scroll lg:animate-none">
            <Image
              src={huacoImage}
              alt={`Bottle of ${huacoData.name}`}
              class="lg:h-full lg:max-h-[550px] w-auto drop-shadow-2xl"
            />
          </div>

          {/* Tarjeta de texto (visible en móvil y desktop) */}
          <div class="parallax-card w-full mt-8 lg:absolute lg:inset-0 lg:flex lg:items-end lg:justify-end lg:mt-0 animate-on-scroll lg:animate-none">
            <div class="w-full lg:w-2/3 bg-text/80 backdrop-blur-sm p-8 md:p-10 rounded-lg shadow-xl text-background lg:m-8">
              <h3 class="font-display text-4xl md:text-6xl font-bold">{huacoData.name}</h3>
              <div class="w-24 h-1 bg-primary mt-4" />
              <div class="mt-8 grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4 text-sm font-body uppercase tracking-wider">
                <p>
                  <>
                    <strong>Category:</strong>
                    <br />
                  </>{" "}
                  {huacoData.category}
                </p>
                <p>
                  <>
                    <strong>Origin:</strong>
                    <br />
                  </>{" "}
                  {huacoData.origin}
                </p>
                <p>
                  <>
                    <strong>Alcohol:</strong>
                    <br />
                  </>{" "}
                  {huacoData.alcohol}
                </p>
              </div>
              <p class="font-body mt-8 text-lg text-background/80 leading-relaxed">{huacoData.description}</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

{
  caminanteData && (
    <section
      class="relative bg-cover bg-center bg-fixed py-24 sm:py-32"
      style={{ backgroundImage: `url(${caminanteBgImage.src})` }}
    >
      <div class="absolute inset-0 bg-black/60" />
      <div class="relative z-10 max-w-7xl mx-auto px-6 lg:px-8">
        <div class="grid grid-cols-1 lg:grid-cols-5 items-center gap-8 lg:gap-0">
          <div class="lg:col-span-3 animate-on-scroll">
            <div class="bg-background/80 backdrop-blur-sm p-8 md:p-10 rounded-lg shadow-xl text-text">
              <h3 class="font-display text-4xl md:text-6xl font-bold">{caminanteData.name}</h3>
              <div class="w-24 h-1 bg-primary mt-4" />
              <div class="mt-8 grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4 text-sm font-body uppercase tracking-wider">
                <p>
                  <>
                    <strong>Category:</strong>
                    <br />
                  </>{" "}
                  {caminanteData.category}
                </p>
                <p>
                  <>
                    <strong>Origin:</strong>
                    <br />
                  </>{" "}
                  {caminanteData.origin}
                </p>
                <p>
                  <>
                    <strong>Alcohol:</strong>
                    <br />
                  </>{" "}
                  {caminanteData.alcohol}
                </p>
                <p>
                  <>
                    <strong>Distillation:</strong>
                    <br />
                  </>{" "}
                  {caminanteData.distillation}
                </p>
                <p>
                  <>
                    <strong>Milling:</strong>
                    <br />
                  </>{" "}
                  {caminanteData.milling}
                </p>
              </div>
              <p class="font-body mt-8 text-lg text-text/80 leading-relaxed">{caminanteData.description}</p>
            </div>
          </div>
          <div class="lg:col-span-2 flex justify-center animate-on-scroll order-first lg:order-last">
            <Image
              src={caminanteImage}
              alt={`Bottle of ${caminanteData.name}`}
              quality="high"
              class="h-full max-h-[550px] w-auto drop-shadow-2xl"
            />
          </div>
        </div>
      </div>
    </section>
  )
}

{
  fortunaData && (
    <section id="fortuna-parallax" class="bg-[var(--color-wood)] py-20 sm:py-24 lg:h-[800px] lg:py-0">
      <div class="max-w-7xl mx-auto px-6 lg:px-8 h-full">
        {/* Contenedor principal que cambia de flex-col a un layout relativo en desktop */}
        <div class="flex flex-col lg:relative items-center justify-center h-full">
          {/* Imagen de fondo (solo para desktop) */}
          <div class="parallax-bg hidden lg:block lg:absolute w-full lg:w-4/5 h-[600px]">
            <Image
              src={fortunaBgImage}
              alt={`Ambiance for ${fortunaData.name}`}
              quality="high"
              class="rounded-lg shadow-2xl shadow-accent/50 h-full w-full object-cover"
            />
          </div>

          {/* Botella (visible en móvil y desktop) */}
          <div class="parallax-bottle w-2/3 sm:w-1/3 lg:absolute lg:inset-0 lg:flex lg:items-center lg:justify-start lg:w-auto animate-on-scroll lg:animate-none">
            <Image
              src={fortunaImage}
              alt={`Bottle of ${fortunaData.name}`}
              class="lg:h-full lg:max-h-[550px] w-auto drop-shadow-2xl"
            />
          </div>

          {/* Tarjeta de texto (visible en móvil y desktop) */}
          <div class="parallax-card w-full mt-8 lg:absolute lg:inset-0 lg:flex lg:items-end lg:justify-end lg:mt-0 animate-on-scroll lg:animate-none">
            <div class="w-full lg:w-2/3 bg-text/80 backdrop-blur-sm p-8 md:p-10 rounded-lg shadow-xl text-background lg:m-8">
              <h3 class="font-display text-4xl md:text-6xl font-bold">{fortunaData.name}</h3>
              <div class="w-24 h-1 bg-primary mt-4" />
              <div class="mt-8 grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4 text-sm font-body uppercase tracking-wider">
                <p>
                  <>
                    <strong>Category:</strong>
                    <br />
                  </>{" "}
                  {fortunaData.category}
                </p>
                <p>
                  <>
                    <strong>Origin:</strong>
                    <br />
                  </>{" "}
                  {fortunaData.origin}
                </p>
                <p>
                  <>
                    <strong>Alcohol:</strong>
                    <br />
                  </>{" "}
                  {fortunaData.alcohol}
                </p>
              </div>
              <p class="font-body mt-8 text-lg text-background/80 leading-relaxed">{fortunaData.description}</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

{
  yuliiaData && (
    <section class="relative py-24 sm:py-32 overflow-hidden">
      <Image
        src={yuliiaBgImage}
        alt="Artisanal mezcal production"
        class="absolute inset-0 w-full h-full object-cover opacity-60 z-0"
      />
      <div class="max-w-7xl mx-auto px-6 lg:px-8">
        <div class="relative grid grid-cols-1 lg:grid-cols-5 items-center gap-8 lg:gap-0">
          <div class="lg:col-span-3 z-10 animate-on-scroll">
            <div class="bg-background/80 backdrop-blur-sm p-8 md:p-10 rounded-lg shadow-xl">
              <h3 class="font-display text-4xl md:text-6xl font-bold text-text">{yuliiaData.name}</h3>
              <div class="w-24 h-1 bg-primary mt-4" />
              <div class="mt-8 grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4 text-sm font-body uppercase tracking-wider">
                <p>
                  <>
                    <strong>Category:</strong>
                    <br />
                  </>{" "}
                  {yuliiaData.category}
                </p>
                <p>
                  <>
                    <strong>Origin:</strong>
                    <br />
                  </>{" "}
                  {yuliiaData.origin}
                </p>
                <p>
                  <>
                    <strong>Alcohol:</strong>
                    <br />
                  </>{" "}
                  {yuliiaData.alcohol}
                </p>
                <p>
                  <>
                    <strong>Distillation:</strong>
                    <br />
                  </>{" "}
                  {yuliiaData.distillation}
                </p>
                <p>
                  <>
                    <strong>Milling:</strong>
                    <br />
                  </>{" "}
                  {yuliiaData.milling}
                </p>
              </div>
              <p class="font-body mt-8 text-lg text-text/80 leading-relaxed">{yuliiaData.description}</p>
            </div>
          </div>
          <div class="lg:col-span-2 flex justify-center lg:justify-end animate-on-scroll order-first lg:order-last">
            <Image
              src={yuliiaImage}
              alt={`Bottle of ${yuliiaData.name}`}
              quality="high"
              class="h-full max-h-[550px] w-auto drop-shadow-2xl"
            />
          </div>
        </div>
      </div>
    </section>
  )
}

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  // Usamos matchMedia para aplicar las animaciones de parallax SOLO en pantallas grandes
  ScrollTrigger.matchMedia({
    // Desktop (y más grande)
    "(min-width: 1024px)": function () {
      // talava
      gsap.fromTo(
        "#talava-parallax .parallax-bg",
        { yPercent: 12 }, // Posición inicial
        {
          yPercent: -6, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#talava-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        "#talava-parallax .parallax-bottle",
        { yPercent: 20 }, // Posición inicial
        {
          yPercent: -20, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#talava-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        "#talava-parallax .parallax-card",
        { yPercent: 10 }, // Posición inicial
        {
          yPercent: -50, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#talava-parallax", scrub: true },
        }
      );

      // huaco
      gsap.fromTo(
        "#huaco-parallax .parallax-bg",
        { yPercent: 12 }, // Posición inicial
        {
          yPercent: -6, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#huaco-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        "#huaco-parallax .parallax-bottle",
        { yPercent: 20 }, // Posición inicial
        {
          yPercent: -20, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#huaco-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        "#huaco-parallax .parallax-card",
        { yPercent: 10 }, // Posición inicial
        {
          yPercent: -50, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#huaco-parallax", scrub: true },
        }
      );
      // fortuna
      gsap.fromTo(
        "#fortuna-parallax .parallax-bg",
        { yPercent: 12 }, // Posición inicial
        {
          yPercent: -6, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#fortuna-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        "#fortuna-parallax .parallax-bottle",
        { yPercent: 20 }, // Posición inicial
        {
          yPercent: -20, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#fortuna-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        "#fortuna-parallax .parallax-card",
        { yPercent: 10 }, // Posición inicial
        {
          yPercent: -50, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#fortuna-parallax", scrub: true },
        }
      );
    },
  });
</script>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  // Usamos matchMedia para aplicar las animaciones de parallax SOLO en pantallas grandes
  ScrollTrigger.matchMedia({
    // Desktop (y más grande)
    "(min-width: 1024px)": function () {
      // huaco
      gsap.fromTo(
        ".parallax-bg",
        { yPercent: 12 }, // Posición inicial
        {
          yPercent: -6, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#huaco-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        ".parallax-bottle",
        { yPercent: 20 }, // Posición inicial
        {
          yPercent: -20, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#huaco-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        ".parallax-card",
        { yPercent: 10 }, // Posición inicial
        {
          yPercent: -50, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#huaco-parallax", scrub: true },
        }
      );
      // fortuna
      gsap.fromTo(
        ".parallax-bg",
        { yPercent: 12 }, // Posición inicial
        {
          yPercent: -6, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#fortuna-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        ".parallax-bottle",
        { yPercent: 20 }, // Posición inicial
        {
          yPercent: -20, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#fortuna-parallax", scrub: true },
        }
      );

      gsap.fromTo(
        ".parallax-card",
        { yPercent: 10 }, // Posición inicial
        {
          yPercent: -50, // Posición final
          ease: "none",
          scrollTrigger: { trigger: "#fortuna-parallax", scrub: true },
        }
      );

    },
  });
</script>
